
### This will eventually be generated by a configure

##########################################################
## Uncomment the Qt section and comment out the GLUT section
## to use Qt. You might have to change the value of 
## QT_DIR
##########################################################
## Qt section
#QT_DIR                 := /usr/lib/qt-3.0.5
#QT_CXXFLAGS            := -I$(QTDIR)/include/ -DGLV_USE_QT
#QT_LIBS                := -L$(QTDIR)/lib -lqt
#QT_PREFIXES_H_CPP_O    := WindowQt
#QT_MOC_GENERATED_FILES := mWindowQt.cpp

#########################################################
# Uncomment the GLUT section and comment out the QT section
# to use GLUT.
#########################################################
# GLUT section
GLUT_PREFIXES_H_CPP_O := WindowGLUT

#########################################################
# Uncomment the OpenGL section and comment out the 
# emptygl section to use OpenGL.
#########################################################
# OpenGL section
GL_INCLUDE_DIR := /usr/include/GL 
GL_LIBS        := -lglut -lGLU -lGL -lX11

##########################################################
## Uncomment the emptygl section and comment out the  
## OpenGL section to use emptygl. You can't use this in
## conjuction with Qt because Qt is pulling the system's
## OpenGL
##########################################################
## emptygl section
#GL_INCLUDE_DIR := ../../emptygl
#GL_LIBS := $(GL_INCLUDE_DIR)/libglut.a $(GL_INCLUDE_DIR)/libGLU.a $(GL_INCLUDE_DIR)/libGL.a

#########################################################
# Uncomment the PNG section to be able to make snapshots
# in PNG format
#########################################################
# PNG section
PNG_CXXFLAGS := -DGLV_USE_PNG
PNG_LIBS     := -lpng

#########################################################
# Uncomment the GLX section to be able to make snapshots
# using the GLX extension (XFree)
#########################################################
# GLX section
GLX_CXXFLAGS := -DGLV_USE_GLX

# Optimisation section
#OPT_CXXFLAGS   := -O3
#OPT_CXXFLAGS   := -O3 -pg 
OPT_CXXFLAGS   := -g -DGLV_DEBUG 

# g++ section
GPP_CXXFLAGS    := -I$(GL_INCLUDE_DIR) -Wall -Winline -Wmissing-prototypes -pedantic -Wno-long-long -pedantic-errors
GPP295_CXXFLAGS := $(GPP_CXXFLAGS) -DGLV_MISSING_LIMITS_HEADER_FILE 
GPP3_CXXFLAGS   := $(GPP_CXXFLAGS)

CXXFLAGS := $(GPP3_CXXFLAGS) $(OPT_CXXFLAGS) $(GLUT_CXXFLAGS) $(QT_CXXFLAGS) $(PNG_CXXFLAGS) $(GLX_CXXFLAGS)

####### You should not have to modify anything below this point #######

PREFIXES_H_CPP_O := \
	BoundingBox \
	GraphicData \
	Matrix4x4 \
	Object \
	Parser \
	PrimitiveAccumulator \
	UserSettings \
	Snapshot \
	Tile \
	Vector3D \
	VertexAccumulator \
	VertexedPrimitiveAccumulator \
	View \
	ViewManager \
	WindowGLV \
	$(GLUT_PREFIXES_H_CPP_O) \
	$(QT_PREFIXES_H_CPP_O) \
	glut_utils \
	string_utils

PREFIXES_H := \
	RenderParameters \
	assert_glv \
	glinclude \
	limits_glv

LIBS := \
	$(GLUT_LIBS) \
	$(QT_LIBS) \
	$(GL_LIBS) \
	$(PNG_LIBS)

H_FILES   := \
	$(QT_PREFIXES_H_CPP_O:%=%.h) \
	$(PREFIXES_H_CPP_O:%=%.h) \
	$(PREFIXES_H:%=%.h)

CPP_FILES := \
	$(PREFIXES_H_CPP_O:%=%.cpp) \
	$(QT_MOC_GENERATED_FILES)

OBJS := \
	$(PREFIXES_H_CPP_O:%=%.o) \
	$(QT_MOC_GENERATED_FILES:%.cpp=%.o)

all: ../glv

clean:
	rm -f $(QT_MOC_GENERATED_FILES) $(OBJS) ../glv


../glv: $(QT_MOC_GENERATED_FILES) $(H_FILES) $(OBJS) main.cpp Makefile
	$(CXX) main.cpp -o ../glv $(CXXFLAGS) $(OBJS) $(LIBS)

%.o: %.cpp $(H_FILES) Makefile
	$(CXX) -c $(CXXFLAGS) -o $@ $< 

m%.cpp: %.h Makefile
	$(QTDIR)/bin/moc $< > $@
